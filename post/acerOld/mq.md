# 消息队列（Message Queue）

消息队列是一个存放消息的容器，是分布式系统中的重要组件，主要作用是通过**异步处理提供系统性能**、**变并行为串行**、**削峰**、**降低系统耦合性**。目前使用较多的是ActiveMQ、RabbitMQ、Kafaka、RocketMQ。**消息队列不仅仅是队列，而是消息中间件的日常称呼。**

## 消息模型

1. 点对点：生产者向队列发送的消息只能**被一个消费者消费一次**。
2. 发布/订阅：生产者向队列的频道发送的消息，**多个消费者可以从这个频道订阅这个消息并消费**。

**观察者模式**与**发布订阅**的区别：

1. **观察者模式**：观察者订阅主题，主题发生变化触发事件，通知观察者。<u>双方可以互相感知</u>；**发布订阅**：生产者向频道发送消息，消费者订阅频道消费消息，<u>双方的交互通过频道连接</u>。
2. **观察者模式**：是<u>同步模式</u>，事件发生会立即通知观察者；**发布订阅**：是<u>异步模式</u>，生产者将消息发送到频道，不用管谁、什么时候消费，消费者订阅频道，有消息就消费，不用管谁发布的。

## 应用场景

1. **异步处理**。因为发布订阅模式是异步的，可以实现一些需要异步的业务。如：支付业务中，一笔订单的发生和扣款短信通知是异步的，将订单推送至消息队列中等待执行，执行成功之后，发送短信通知用户。
2. **流量削峰**。短时间内大量请求到达服务器，会使服务器来不及处理，可将请求放置队列中，服务器按照处理能力从队列中取出请求进行处理。如秒杀。
3. **应用解耦**。模块之间通过消息进行通信可以降低模块间耦合度。如发布订阅模式就是一种更灵活的耦合方式。

## Kafka



## RabbitMQ

### 角色

rabbitmq 中的重要角色为：生产者、消费者和代理

1. 生产者：消息的创建者，负责消息的创建和推送到服务器
2. 消费者：消息的接收方，用于处理数据和确认。接收数据有推和拉两种模式。
3. 代理：即 RabbitMQ 本身，介于生产者和消费者之间的角色，用于缓存、传递信息。

